name: "execution policy CI workflow "


on:
  push:
    branches: [ test ]



jobs:

  windows-latest-pwsh-scripts:
    name: "pwsh scripts - windows-latest "  
    runs-on: windows-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v1

    - name: "powershell version" 
      run: |
        $PSVersionTable
        pwsh                              

    - name: "test verbose" 
      run: .\scripts\Test_Verbose.ps1
      shell: pwsh    

    - name: "windows version" 
      run: .\scripts\Windows_Version.ps1
      shell: pwsh  

    - name: "Set PowerShell execution policy"
      run: |
          Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

    - name: "Run PowerShell script that retrieves and sets the execution policy for the script runner"
      run: |
          & "retrieves and sets the execution policy for the script runner.ps1"

    - name: "Run PowerShell script that retrieves and sets the execution policy for the script runner"
      run: |
          & "\scripts\retrieves and sets the execution policy for the script runner.ps1"
          
    - name: "retrieves and sets the execution policy for the script runner " 
      run: '.\scripts\retrieves and sets the execution policy for the script runner.ps1'
      shell: pwsh 
     
